var ajaxurl=meta_image.ajaxurl,user={onReady:function(){user.imageUploader(),user.removeImage(),user.imageDrop()},imageUploader:function(){var e;jQuery(".upload-image").click(function(a){a.preventDefault();var t=jQuery(this),r=jQuery(this).parent(),u=r.attr("data-img"),i=r.attr("data-input"),n=r.attr("data-user"),o=jQuery("#"+i),m=jQuery("."+u);e=wp.media.frames.meta_image_frame=wp.media({title:meta_image.title,button:{text:meta_image.button},library:{type:"image"},multiple:!1}),e.on("select",function(){var a=e.state().get("selection").first().toJSON();m.find("img").remove(),m.append('<img src="'+a.url+'" alt="" />'),o.val(a.url),r.append('<button class="remove-image button button-large heard-btn">Remove</button>'),t.remove(),user.saveImage(i,n,a.url)}),e.open()})},removeImage:function(){jQuery(".remove-image").click(function(e){e.preventDefault();var a=jQuery(this).parent().attr("data-input"),t=jQuery(this).parent().attr("data-user");jQuery(this).parent().find("input").val(""),jQuery(this).parent().find("img").remove(),user.saveImage(a,t,""),jQuery(this).parent().append('<button class="add button button-large upload-image" id="upload-logo" style="text-align:center;" data-input="agent_image" data-img="profile" data-user="<?php echo $user_id; ?>">Upload/Set Profile Image</button>'),jQuery(this).remove(),user.imageUploader()})},saveImage:function(e,a,t){jQuery.ajax({url:ajaxurl,type:"GET",data:{imageField:e,fieldVal:t,userID:a,action:"setImage"},dataType:"html",success:function(){user.removeImage()},error:function(e,a,t){window.alert(e+" :: "+a+" :: "+t)}})},dropImage:function(e,a,t,r){jQuery.ajax({url:ajaxurl,type:"GET",data:{imageField:e,imageVal:t,userID:a,action:"dropImage"},processData:!1,contentType:!1,success:function(e,a){jQuery("#"+e).css("background","url("+a+") no-repeat scroll center / cover")},error:function(e,a,t){window.alert(e+" :: "+a+" :: "+t)}})},imageDrop:function(){jQuery("input[type=file]").change(function(e){var a=jQuery(this).attr("name"),t=jQuery(this).attr("data-user"),r=jQuery(this).attr("data-target");user.dropImage(a,t,image,r)})}};jQuery(document).ready(function(){user.onReady()});